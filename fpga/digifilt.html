<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>Digital Filters</title>
    
    <link rel="stylesheet" type="text/css" href="http://www.thescrapyard.org/css/markdown.css" />

    <script type="text/javascript" src="http://www.thescrapyard.org/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link href="http://www.thescrapyard.org/prettify/tomorrow.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="http://www.thescrapyard.org/prettify/prettify.js"></script>

    <!-- <script type="text/javascript" src="http://www.thescrapyard.org/prettify/run_prettify.js?skin=tomorrow"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52980401-1', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body onload="prettyPrint()">
    <div class="container">
      <!-- Markdown content starts here -->

<hr>



<h1 id="digital-filters">Digital Filters</h1>

<p>A collection of various digital filters I’ve designed as they were needed for other projects.</p>

<hr>

<p><div class="toc"><div class="toc">
<ul>
<li><a href="#digital-filters">Digital Filters</a><ul>
<li><a href="#narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</a><ul>
<li><a href="#efficient-filter-implementation">Efficient filter implementation</a></li>
<li><a href="#narrowing-the-filter">Narrowing the filter</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</p>

<hr>



<h2 id="narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</h2>

<p>As part of my LF/VLF experiments, I wanted a narrowband 60 kHz filter for receiving the time broadcast by NIST on station <a href="http://en.wikipedia.org/wiki/WWVB">WWVB</a>. The bandwidth needed is minimal, as basic time information is only transmitted at 1 bps, so the narrower the filter, the better. I first considered a filter based on the <a href="http://en.wikipedia.org/wiki/Goertzel_algorithm">Goertzel algorithm</a>, but set it aside due to its instability and instead decided to use a <a href="http://en.wikipedia.org/wiki/Matched_filter">matched filter</a>.</p>



<h3 id="efficient-filter-implementation">Efficient filter implementation</h3>

<p>What I want to share here is not the matched filter itself, as there’s nothing special about that, but rather how it will be implemented. Given my system parameters - 60 kHz filter with a 3 MHz sampling frequency - a straightforward FIR matched filter of only one period in length would require 50 complex-coefficient taps. Using real-valued coefficients, either the sine or cosine rather than <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4698-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78479" style="width: 2.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78480"><span class="msubsup" id="MathJax-Span-78481"><span style="display: inline-block; position: relative; width: 2.155em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78482" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.503em;"><span class="texatom" id="MathJax-Span-78483"><span class="mrow" id="MathJax-Span-78484"><span class="mo" id="MathJax-Span-78485" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-78487" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-78488" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4698">e^{-j2\pi}</script>, slightly distorts the filter response, but it remains acceptable. More importantly, because of symmetries in the coefficients, it is possible to reduce this filter to a 12-tap FIR filter with some additional delays and summations.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4699-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78489" style="width: 8.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.31em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78490"><span class="mi" id="MathJax-Span-78491" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78492" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-78493" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78494" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.448em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78495"><span class="mrow" id="MathJax-Span-78496"><span class="mn" id="MathJax-Span-78497" style="font-size: 70.7%; font-family: MathJax_Main;">49</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78498"><span class="mrow" id="MathJax-Span-78499"><span class="mi" id="MathJax-Span-78500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78501" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78502" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78503" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78504" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78506"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78507" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78508"><span class="mrow" id="MathJax-Span-78509"><span class="mo" id="MathJax-Span-78510" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4699">f = \sum_{n=0}^{49}a_nz^{-n}</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4700-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78512" style="width: 6.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.109em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 3.006em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78513"><span class="msubsup" id="MathJax-Span-78514"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78515" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-78517" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="msubsup" id="MathJax-Span-78518" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 3.656em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78519" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.503em;"><span class="texatom" id="MathJax-Span-78520"><span class="mrow" id="MathJax-Span-78521"><span class="mo" id="MathJax-Span-78522" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-78524" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-78525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-78526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-78527"><span class="mrow" id="MathJax-Span-78528"><span class="mo" id="MathJax-Span-78529" style="font-size: 70.7%; font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-78530" style="font-size: 70.7%; font-family: MathJax_Main;">50</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4700">a_n = e^{-j2\pi n/50}</script></center><p></p>

<p>These two equations give the formula for the FIR filter using the z-transform. This could be directly and inefficiently implemented as a 50-tap delay line and 50 multipliers. Examining <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4701-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78531" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78532"><span class="msubsup" id="MathJax-Span-78533"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78534" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78535" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4701">a_n</script>, however, one can see that there are only 13 unique coefficients, one of which is zero, corresponding to the values of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4702-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78536" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78537"><span class="mi" id="MathJax-Span-78538" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-78539" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-78540" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4702">sin</script> between <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4703-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78541" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78542"><span class="mn" id="MathJax-Span-78543" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4703">0</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4704-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78544" style="width: 1.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.448em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78545"><span class="mi" id="MathJax-Span-78546" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-78547"><span class="mrow" id="MathJax-Span-78548"><span class="mo" id="MathJax-Span-78549" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-78550" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4704">\pi/2</script>. All other coefficients are either mirrored or negated versions thereof. We can therefore rewrite the filter more efficiently, as follows.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4705-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78551" style="width: 13.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.864em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78552"><span class="mi" id="MathJax-Span-78553" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78554" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-78555" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-78556" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78557" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-78558" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78559" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78560"><span class="mrow" id="MathJax-Span-78561"><span class="mo" id="MathJax-Span-78562" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78563" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78564" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-78565" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78566" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78567"><span class="mrow" id="MathJax-Span-78568"><span class="mn" id="MathJax-Span-78569" style="font-size: 70.7%; font-family: MathJax_Main;">24</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78570"><span class="mrow" id="MathJax-Span-78571"><span class="mi" id="MathJax-Span-78572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78573" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78574" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78575" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78576" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78578"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78579" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78580"><span class="mrow" id="MathJax-Span-78581"><span class="mo" id="MathJax-Span-78582" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4705">f = (1 - z^{-25})\sum_{n=0}^{24}a_nz^{-n}</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4706-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78584" style="width: 27.28em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78585"><span class="mi" id="MathJax-Span-78586" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78587" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-78588" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-78589" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78590" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-78591" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78592" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78593"><span class="mrow" id="MathJax-Span-78594"><span class="mo" id="MathJax-Span-78595" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78596" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78597" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-78598" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-78599"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78600" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-78601" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78602" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="munderover" id="MathJax-Span-78603" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78604" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78605"><span class="mrow" id="MathJax-Span-78606"><span class="mn" id="MathJax-Span-78607" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78608"><span class="mrow" id="MathJax-Span-78609"><span class="mi" id="MathJax-Span-78610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78611" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78612" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78613" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78614" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78616"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78617" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78618"><span class="mrow" id="MathJax-Span-78619"><span class="mo" id="MathJax-Span-78620" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78622" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-78623" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78624" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78625"><span class="mrow" id="MathJax-Span-78626"><span class="mo" id="MathJax-Span-78627" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78628" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="munderover" id="MathJax-Span-78629" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78630" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78631"><span class="mrow" id="MathJax-Span-78632"><span class="mn" id="MathJax-Span-78633" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78634"><span class="mrow" id="MathJax-Span-78635"><span class="mi" id="MathJax-Span-78636" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78637" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78638" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78639" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78640" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78641"><span class="mrow" id="MathJax-Span-78642"><span class="mn" id="MathJax-Span-78643" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-78644" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78646"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78647" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78648"><span class="mrow" id="MathJax-Span-78649"><span class="mo" id="MathJax-Span-78650" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78652" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4706">f = (1 - z^{-25})(a_0 + \sum_{n=1}^{12}a_nz^{-n} + z^{-12}\sum_{n=1}^{12}a_{12-n}z^{-n})</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4707-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78653" style="width: 23.176em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.873em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78654"><span class="mi" id="MathJax-Span-78655" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78656" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-78657" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-78658" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78659" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-78660" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78661" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78662"><span class="mrow" id="MathJax-Span-78663"><span class="mo" id="MathJax-Span-78664" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78665" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78666" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-78667" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-78668"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78669" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-78670" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78671" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="munderover" id="MathJax-Span-78672" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78673" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78674"><span class="mrow" id="MathJax-Span-78675"><span class="mn" id="MathJax-Span-78676" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78677"><span class="mrow" id="MathJax-Span-78678"><span class="mi" id="MathJax-Span-78679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78680" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78681" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78682" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78683" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78684"><span class="mrow" id="MathJax-Span-78685"><span class="mo" id="MathJax-Span-78686" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78688" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-78689"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78690" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78691" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-78692" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-78693" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78694" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78695"><span class="mrow" id="MathJax-Span-78696"><span class="mo" id="MathJax-Span-78697" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78698" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78699"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78700" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78701"><span class="mrow" id="MathJax-Span-78702"><span class="mn" id="MathJax-Span-78703" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-78704" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78706" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-78707" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4707">f = (1 - z^{-25})(a_0 + \sum_{n=1}^{12}z^{-n}(a_n + z^{-12}a_{12-n}))</script></center><p></p>

<p>When <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4708-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78708" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78709"><span class="msubsup" id="MathJax-Span-78710"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78711" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4708">a_n</script> is defined as a function of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4709-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78713" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78714"><span class="mi" id="MathJax-Span-78715" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-78716" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-78717" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4709">sin</script>, the first coefficient <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4710-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78718" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78719"><span class="msubsup" id="MathJax-Span-78720"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78721" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-78722" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4710">a_0</script> is zero.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4711-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78723" style="width: 20.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.071em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78724"><span class="mi" id="MathJax-Span-78725" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78726" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-78727" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-78728" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78729" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-78730" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78731" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78732"><span class="mrow" id="MathJax-Span-78733"><span class="mo" id="MathJax-Span-78734" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78735" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78736" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-78737" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78738" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78739"><span class="mrow" id="MathJax-Span-78740"><span class="mn" id="MathJax-Span-78741" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78742"><span class="mrow" id="MathJax-Span-78743"><span class="mi" id="MathJax-Span-78744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78745" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78746" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78747" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78748" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78749"><span class="mrow" id="MathJax-Span-78750"><span class="mo" id="MathJax-Span-78751" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78752" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78753" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-78754"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78755" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-78757" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-78758" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78759" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78760"><span class="mrow" id="MathJax-Span-78761"><span class="mo" id="MathJax-Span-78762" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78763" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78764"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78765" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78766"><span class="mrow" id="MathJax-Span-78767"><span class="mn" id="MathJax-Span-78768" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-78769" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78771" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4711">f = (1 - z^{-25})\sum_{n=1}^{12}z^{-n}(a_n + z^{-12}a_{12-n})</script></center><p></p>

<p>The first <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4712-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78772" style="width: 4.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.457em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78773"><span class="mo" id="MathJax-Span-78774" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-78775" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78776" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-78777" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78778" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78779"><span class="mrow" id="MathJax-Span-78780"><span class="mo" id="MathJax-Span-78781" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78782" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78783" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4712">(1-z^{-25})</script> term is easy to implement as a delay line and a sum on the input to the multipliers, or it can be placed at the output of the filter. The two sums <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4713-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78784" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78785"><span class="msubsup" id="MathJax-Span-78786"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78787" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-78788" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4713">a_n</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4714-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78789" style="width: 2.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78790"><span class="msubsup" id="MathJax-Span-78791"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78792" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78793"><span class="mrow" id="MathJax-Span-78794"><span class="mn" id="MathJax-Span-78795" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-78796" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-78797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4714">a_{12-n}</script> can be computed from the same set of multipliers by using the <em>transposed form</em> of a FIR filter, summing both to the left and to the right after the multipliers. The output from these two can then be summed, the appropriate one first being multiplied by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4715-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78798" style="width: 2.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78799"><span class="msubsup" id="MathJax-Span-78800"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78801" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78802"><span class="mrow" id="MathJax-Span-78803"><span class="mo" id="MathJax-Span-78804" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78805" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4715">z^{-12}</script>.</p>

<p>12 multipliers, 24 two-term adders, and 61 delay elements to implement a 50-tap filter, as opposed to 50 multipliers, 49 delay elements and 1 fifty-term adder.</p>



<h3 id="narrowing-the-filter">Narrowing the filter</h3>

<p>A single-period matched sine filter will not be narrow enough for WWVB reception. As you can see in the figure below, the single period filter, green, has a 60 kHz bandwidth. Increasing the number of periods will narrow the filter and is best done with a second filter, either a FIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4760-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-79538" style="width: 5.858em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.258em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.154em 1000.003em 2.705em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-79539"><span class="munderover" id="MathJax-Span-79540"><span style="display: inline-block; position: relative; width: 2.705em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-79541" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.448em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-79542"><span class="mrow" id="MathJax-Span-79543"><span class="mi" id="MathJax-Span-79544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-79545" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-79546" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-79547"><span class="mrow" id="MathJax-Span-79548"><span class="mi" id="MathJax-Span-79549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-79550" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-79551" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-79552" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-79553" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-79554"><span class="mrow" id="MathJax-Span-79555"><span class="mo" id="MathJax-Span-79556" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-79557" style="font-size: 70.7%; font-family: MathJax_Main;">50</span><span class="mi" id="MathJax-Span-79558" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4760">\sum_{n=0}^{N-1} z^{-50n}</script>, not shown, or an IIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4761-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-79559" style="width: 10.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.812em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-79560"><span class="mn" id="MathJax-Span-79561" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-79562"><span class="mrow" id="MathJax-Span-79563"><span class="mo" id="MathJax-Span-79564" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-79565" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-79566" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-79567" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="mo" id="MathJax-Span-79568" style="font-family: MathJax_Main; padding-left: 0.203em;">(</span><span class="mn" id="MathJax-Span-79569" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-79570" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="mn" id="MathJax-Span-79571" style="font-family: MathJax_Main; padding-left: 0.203em;">1</span><span class="texatom" id="MathJax-Span-79572"><span class="mrow" id="MathJax-Span-79573"><span class="mo" id="MathJax-Span-79574" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-79575" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-79576" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-79577"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-79578" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-79579"><span class="mrow" id="MathJax-Span-79580"><span class="mo" id="MathJax-Span-79581" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-79582" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-79583" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4761">1/(1 + (1-1/N)z^{-25} )</script>, blue.</p>

<p></p><figure><img src="images/60kHz_matched_comb_filter.png" alt="Filter characteristic" title=""> <br>
<figcaption>Comparison of FIR and IIR filters for 60 kHz</figcaption> <br>
</figure><p></p>

<p>The IIR filter results in a sharper filter for a given <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4762-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-79584" style="width: 1.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-79585"><span class="mi" id="MathJax-Span-79586" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4762">N</script> and it requires fewer delay elements. The (1-1/N) term can be implemented as a sum of bit shifts if N is a power of 2. Either filter should be placed after a decimator, 25x in this case, to reduce the number of delay elements needed.</p>

<hr>

<p></p>

<ul>
<li><a href="../">Back to Main Page</a></li>
</ul>

<p>Last updated on 2014-09-17</p>

<p></p>

     <!-- Markdown content ends here -->
    </div>

    <hr>
    <p>Written with <a href="https://stackedit.io/">StackEdit</a> using <a href="http://kevinburke.bitbucket.org/markdowncss/">markdown.css</a>, <a href="https://code.google.com/p/google-code-prettify/">google-code-prettify</a> and <a href="http://www.mathjax.org/">MathJax</a>.</p>

  </body>
</html>