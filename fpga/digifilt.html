<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>Digital Filters</title>
    
    <link rel="stylesheet" type="text/css" href="http://www.thescrapyard.org/css/markdown.css" />

    <script type="text/javascript" src="http://www.thescrapyard.org/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link href="http://www.thescrapyard.org/prettify/tomorrow.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="http://www.thescrapyard.org/prettify/prettify.js"></script>

    <!-- <script type="text/javascript" src="http://www.thescrapyard.org/prettify/run_prettify.js?skin=tomorrow"></script> -->

  </head>
  <body onload="prettyPrint()">
    <div class="container">
      <!-- Markdown content starts here -->

<hr>



<h1 id="digital-filters">Digital Filters</h1>

<p>A collection of various digital filters I’ve designed as they were needed for other projects.</p>

<hr>

<p><div class="toc"><div class="toc">
<ul>
<li><a href="#digital-filters">Digital Filters</a><ul>
<li><a href="#narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</a><ul>
<li><a href="#efficient-filter-implementation">Efficient filter implementation</a></li>
<li><a href="#narrowing-the-filter">Narrowing the filter</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</p>

<hr>



<h2 id="narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</h2>

<p>As part of my LF/VLF experiments, I wanted a narrowband 60 kHz filter for receiving the time broadcast by NIST on station <a href="http://en.wikipedia.org/wiki/WWVB">WWVB</a>. The bandwidth needed is minimal, as basic time information is only transmitted at 1 bps, so the narrower the filter, the better. I first considered a filter based on the <a href="http://en.wikipedia.org/wiki/Goertzel_algorithm">Goertzel algorithm</a>, but set it aside due to its instability and instead decided to use a <a href="http://en.wikipedia.org/wiki/Matched_filter">matched filter</a>.</p>



<h3 id="efficient-filter-implementation">Efficient filter implementation</h3>

<p>What I want to share here is not the matched filter itself, as there’s nothing special about that, but rather how it will be implemented. Given my system parameters - 60 kHz filter with a 3 MHz sampling frequency - a straightforward FIR matched filter of only one period in length would require 50 complex-coefficient taps. Using real-valued coefficients, either the sine or cosine rather than <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4428-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93630" style="width: 2.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93631"><span class="msubsup" id="MathJax-Span-93632"><span style="display: inline-block; position: relative; width: 2.155em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93633" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.503em;"><span class="texatom" id="MathJax-Span-93634"><span class="mrow" id="MathJax-Span-93635"><span class="mo" id="MathJax-Span-93636" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-93638" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-93639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4428">e^{-j2\pi}</script>, slightly distorts the filter response, but it remains acceptable. More importantly, because of symmetries in the coefficients, it is possible to reduce this filter to a 12-tap FIR filter with some additional delays and summations.</p>

<p></p><center> <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4429-Frame"><nobr><span class="math" id="MathJax-Span-93640" style="width: 7.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.609em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.348em 1000.003em 4.357em -0.248em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93641"><span class="mtable" id="MathJax-Span-93642" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 6.259em; height: 0px;"><span style="position: absolute; clip: rect(2.755em 1000.003em 7.41em -0.398em); top: -5.353em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.259em; height: 0px;"><span style="position: absolute; clip: rect(0.803em 1000.003em 4.057em -0.398em); top: -3.451em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93643"><span class="mrow" id="MathJax-Span-93644"><span class="mi" id="MathJax-Span-93645" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-93646" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-93647" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px;"><span style="position: absolute; clip: rect(2.655em 1000.003em 4.357em -0.398em); top: -3.751em; left: 0.003em;"><span class="mo" id="MathJax-Span-93648" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.756em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.655em -0.448em); top: -1.299em; left: 0.053em;"><span class="texatom" id="MathJax-Span-93649"><span class="mrow" id="MathJax-Span-93650"><span class="mi" id="MathJax-Span-93651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93652" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-93653" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.448em); top: -3.551em; left: 0.353em;"><span class="texatom" id="MathJax-Span-93654"><span class="mrow" id="MathJax-Span-93655"><span class="mn" id="MathJax-Span-93656" style="font-size: 70.7%; font-family: MathJax_Main;">49</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93657" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93658" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93659" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93660"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93661" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93662"><span class="mrow" id="MathJax-Span-93663"><span class="mo" id="MathJax-Span-93664" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93665" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.554em 1000.003em 3.006em -0.398em); top: -0.948em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93666"><span class="mrow" id="MathJax-Span-93667"><span class="msubsup" id="MathJax-Span-93668"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93669" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-93671" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="msubsup" id="MathJax-Span-93672" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 3.006em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93673" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.85em; left: 0.503em;"><span class="texatom" id="MathJax-Span-93674"><span class="mrow" id="MathJax-Span-93675"><span class="mo" id="MathJax-Span-93676" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93677" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-93678" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-93679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-93680"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.405em -0.448em); top: -2.6em; left: 50%; margin-left: -0.148em;"><span class="mi" id="MathJax-Span-93681" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.455em -0.448em); top: -1.999em; left: 50%; margin-left: -0.248em;"><span class="mn" id="MathJax-Span-93682" style="font-size: 50%; font-family: MathJax_Main;">50</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000.003em 1.204em -0.448em); top: -1.199em; left: 0.003em;"><span style="border-left-width: 0.603em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.054em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.358em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.003em; vertical-align: -2.219em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4429">\begin{eqnarray}
f = \sum_{n=0}^{49}a_nz^{-n}\\
a_n = e^{-j2\pi \frac{n}{50}}
\end{eqnarray}</script> <br>
</center><p></p>

<p>These two equations give the formula for the FIR filter using the z-transform. This could be directly and inefficiently implemented as a 50-tap delay line and 50 multipliers. Examining <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4430-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93683" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93684"><span class="msubsup" id="MathJax-Span-93685"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93686" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4430">a_n</script>, however, one can see that there are only 13 unique coefficients, corresponding to values of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4431-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93688" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93689"><span class="mi" id="MathJax-Span-93690" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4431">n</script> for which the argument of the exponent is between <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4432-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93691" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93692"><span class="mn" id="MathJax-Span-93693" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4432">0</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4433-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93694" style="width: 1.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.448em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93695"><span class="mi" id="MathJax-Span-93696" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-93697"><span class="mrow" id="MathJax-Span-93698"><span class="mo" id="MathJax-Span-93699" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-93700" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4433">\pi/2</script>. All other coefficients are either mirrored or negated versions thereof. For instance, when <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4434-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93701" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93702"><span class="msubsup" id="MathJax-Span-93703"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93704" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4434">a_n</script> is defined as a function of a sine: </p>

<p></p><center> <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4435-Frame"><nobr><span class="math" id="MathJax-Span-93706" style="width: 13.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.864em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.003em 1000.003em 4.007em -0.298em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93707"><span class="mtable" id="MathJax-Span-93708" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 11.514em; height: 0px;"><span style="position: absolute; clip: rect(2.555em 1000.003em 5.508em -0.448em); top: -4.002em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.856em 1000.003em 4.157em -0.448em); top: -5.303em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93709"><span class="mrow" id="MathJax-Span-93710"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.856em 1000.003em 4.157em -0.448em); top: -4.002em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93718"><span class="mrow" id="MathJax-Span-93719"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.856em 1000.003em 4.157em -0.448em); top: -2.65em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93743"><span class="mrow" id="MathJax-Span-93744"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.455em 1000.003em 6.309em -0.398em); top: -4.552em; left: 0.303em;"><span style="display: inline-block; position: relative; width: 11.214em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 3.006em -0.398em); top: -4.002em; left: 50%; margin-left: -1.449em;"><span class="mtd" id="MathJax-Span-93711"><span class="mrow" id="MathJax-Span-93712"><span class="msubsup" id="MathJax-Span-93713"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93714" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-93715" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93716" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mn" id="MathJax-Span-93717" style="font-family: MathJax_Main; padding-left: 0.303em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 50%; margin-left: -5.603em;"><span class="mtd" id="MathJax-Span-93720"><span class="mrow" id="MathJax-Span-93721"><span class="msubsup" id="MathJax-Span-93722"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93723" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93724" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-93725" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-93726" style="font-family: MathJax_Main; padding-left: 0.303em;">−</span><span class="msubsup" id="MathJax-Span-93727"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93728" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93729"><span class="mrow" id="MathJax-Span-93730"><span class="mi" id="MathJax-Span-93731" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93732" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93733" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mi" id="MathJax-Span-93734" style="font-family: MathJax_Main;">∀</span><span class="mtext" id="MathJax-Span-93735" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-93736" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93737" style="font-family: MathJax_Main; padding-left: 0.303em;">∈</span><span class="mo" id="MathJax-Span-93738" style="font-family: MathJax_Main; padding-left: 0.303em;">[</span><span class="mn" id="MathJax-Span-93739" style="font-family: MathJax_Main;">25</span><span class="mo" id="MathJax-Span-93740" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-93741" style="font-family: MathJax_Main; padding-left: 0.153em;">49</span><span class="mo" id="MathJax-Span-93742" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -1.349em; left: 50%; margin-left: -5.203em;"><span class="mtd" id="MathJax-Span-93745"><span class="mrow" id="MathJax-Span-93746"><span class="msubsup" id="MathJax-Span-93747"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93748" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93749" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-93750" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="msubsup" id="MathJax-Span-93751" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93752" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93753"><span class="mrow" id="MathJax-Span-93754"><span class="mn" id="MathJax-Span-93755" style="font-size: 70.7%; font-family: MathJax_Main;">25</span><span class="mo" id="MathJax-Span-93756" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mi" id="MathJax-Span-93758" style="font-family: MathJax_Main;">∀</span><span class="mtext" id="MathJax-Span-93759" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-93760" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93761" style="font-family: MathJax_Main; padding-left: 0.303em;">∈</span><span class="mo" id="MathJax-Span-93762" style="font-family: MathJax_Main; padding-left: 0.303em;">[</span><span class="mn" id="MathJax-Span-93763" style="font-family: MathJax_Main;">13</span><span class="mo" id="MathJax-Span-93764" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-93765" style="font-family: MathJax_Main; padding-left: 0.153em;">24</span><span class="mo" id="MathJax-Span-93766" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.557em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.225em; vertical-align: -1.831em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4435">\begin{eqnarray}
&a_0 = 0\\
&a_n = -a_{n-25} \forall\ n \in [25, 49]\\
&a_n = a_{25-n} \forall\ n \in [13, 24]
\end{eqnarray}</script> <br>
</center><p></p>

<p>We can therefore rewrite the filter more efficiently, as follows.</p>



<p></p><center> <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4436-Frame"><nobr><span class="math" id="MathJax-Span-93767" style="width: 24.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.874em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.249em 1000.003em 5.258em -0.298em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93768"><span class="mtable" id="MathJax-Span-93769" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 21.524em; height: 0px;"><span style="position: absolute; clip: rect(2.455em 1000.003em 6.009em -0.448em); top: -4.252em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.856em 1000.003em 4.157em -0.448em); top: -5.653em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93770"><span class="mrow" id="MathJax-Span-93771"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.856em 1000.003em 4.157em -0.448em); top: -2.4em; right: 0.003em;"><span class="mtd" id="MathJax-Span-93806"><span class="mrow" id="MathJax-Span-93807"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.257em;"></span></span><span style="position: absolute; clip: rect(3.706em 1000.003em 10.213em -0.398em); top: -7.205em; left: 0.303em;"><span style="display: inline-block; position: relative; width: 21.224em; height: 0px;"><span style="position: absolute; clip: rect(1.854em 1000.003em 5.108em -0.398em); top: -5.403em; left: 50%; margin-left: -5.753em;"><span class="mtd" id="MathJax-Span-93772"><span class="mrow" id="MathJax-Span-93773"><span class="mi" id="MathJax-Span-93774" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-93775" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mrow" id="MathJax-Span-93776" style="padding-left: 0.303em;"><span class="mo" id="MathJax-Span-93777" style="vertical-align: 0.003em; padding-left: 0.303em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mn" id="MathJax-Span-93778" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-93779" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-93780" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93781" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93782"><span class="mrow" id="MathJax-Span-93783"><span class="mo" id="MathJax-Span-93784" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93785" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93786" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="munderover" id="MathJax-Span-93787" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px;"><span style="position: absolute; clip: rect(2.655em 1000.003em 4.357em -0.398em); top: -3.751em; left: 0.003em;"><span class="mo" id="MathJax-Span-93788" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.756em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.655em -0.448em); top: -1.299em; left: 0.053em;"><span class="texatom" id="MathJax-Span-93789"><span class="mrow" id="MathJax-Span-93790"><span class="mi" id="MathJax-Span-93791" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93792" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-93793" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -3.551em; left: 0.353em;"><span class="texatom" id="MathJax-Span-93794"><span class="mrow" id="MathJax-Span-93795"><span class="mn" id="MathJax-Span-93796" style="font-size: 70.7%; font-family: MathJax_Main;">24</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93797" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93798" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93799" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93800"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93801" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93802"><span class="mrow" id="MathJax-Span-93803"><span class="mo" id="MathJax-Span-93804" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93805" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.756em;"></span></span><span style="position: absolute; clip: rect(2.605em 1000.003em 5.908em -0.198em); top: -2.9em; left: 50%; margin-left: -10.608em;"><span class="mtd" id="MathJax-Span-93808"><span class="mrow" id="MathJax-Span-93809"><span class="mo" id="MathJax-Span-93810" style="font-family: MathJax_Main; padding-left: 0.203em; padding-right: 0.353em;">=</span><span class="mrow" id="MathJax-Span-93811"><span class="mo" id="MathJax-Span-93812" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mn" id="MathJax-Span-93813" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-93814" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-93815" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93816" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93817"><span class="mrow" id="MathJax-Span-93818"><span class="mo" id="MathJax-Span-93819" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93820" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93821" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mrow" id="MathJax-Span-93822" style="padding-left: 0.153em;"><span class="mo" id="MathJax-Span-93823" style="vertical-align: 0.003em; padding-left: 0.153em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="munderover" id="MathJax-Span-93824"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px;"><span style="position: absolute; clip: rect(2.655em 1000.003em 4.357em -0.398em); top: -3.751em; left: 0.003em;"><span class="mo" id="MathJax-Span-93825" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.756em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.655em -0.448em); top: -1.299em; left: 0.053em;"><span class="texatom" id="MathJax-Span-93826"><span class="mrow" id="MathJax-Span-93827"><span class="mi" id="MathJax-Span-93828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93829" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-93830" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.704em 1000.003em 2.555em -0.398em); top: -3.551em; left: 0.353em;"><span class="texatom" id="MathJax-Span-93831"><span class="mrow" id="MathJax-Span-93832"><span class="mn" id="MathJax-Span-93833" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93834" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93835" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93837"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93838" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93839"><span class="mrow" id="MathJax-Span-93840"><span class="mo" id="MathJax-Span-93841" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93842" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93843" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-93844" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93845" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93846"><span class="mrow" id="MathJax-Span-93847"><span class="mo" id="MathJax-Span-93848" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93849" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="munderover" id="MathJax-Span-93850" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px;"><span style="position: absolute; clip: rect(2.655em 1000.003em 4.357em -0.398em); top: -3.751em; left: 0.003em;"><span class="mo" id="MathJax-Span-93851" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.756em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.655em -0.448em); top: -1.299em; left: 0.053em;"><span class="texatom" id="MathJax-Span-93852"><span class="mrow" id="MathJax-Span-93853"><span class="mi" id="MathJax-Span-93854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-93855" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-93856" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.704em 1000.003em 2.555em -0.398em); top: -3.551em; left: 0.353em;"><span class="texatom" id="MathJax-Span-93857"><span class="mrow" id="MathJax-Span-93858"><span class="mn" id="MathJax-Span-93859" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93860" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93861" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93862"><span class="mrow" id="MathJax-Span-93863"><span class="mn" id="MathJax-Span-93864" style="font-size: 70.7%; font-family: MathJax_Main;">13</span><span class="mo" id="MathJax-Span-93865" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93866" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-93867"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93868" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93869"><span class="mrow" id="MathJax-Span-93870"><span class="mo" id="MathJax-Span-93871" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93873" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.507em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.21em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7.003em; vertical-align: -3.219em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4436">\begin{eqnarray}
&f = \left(1 - z^{-25}\right)\sum_{n=1}^{24}a_nz^{-n}\\
&= \left(1 - z^{-25}\right)\left(\sum_{n=1}^{12}a_nz^{-n} + z^{-12}\sum_{n=1}^{12}a_{13-n}z^{-n}\right)
\end{eqnarray}</script> <br>
</center><p></p>



<p>The first <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4437-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93874" style="width: 4.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.457em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93875"><span class="mo" id="MathJax-Span-93876" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-93877" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-93878" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-93879" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93880" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93881"><span class="mrow" id="MathJax-Span-93882"><span class="mo" id="MathJax-Span-93883" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93884" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-93885" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4437">(1-z^{-25})</script> term is easy to implement as a delay line and a sum at the output of the filter, and could potentially be moved to after later decimation steps. The sums of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4438-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93886" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93887"><span class="msubsup" id="MathJax-Span-93888"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93889" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-93890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4438">a_n</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4439-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93891" style="width: 2.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93892"><span class="msubsup" id="MathJax-Span-93893"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93894" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93895"><span class="mrow" id="MathJax-Span-93896"><span class="mn" id="MathJax-Span-93897" style="font-size: 70.7%; font-family: MathJax_Main;">13</span><span class="mo" id="MathJax-Span-93898" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-93899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4439">a_{13-n}</script> can be computed from the same set of multipliers by using the <em>transposed form</em> of a FIR filter, summing both to the left and to the right after the multipliers. The output from these two can then be summed, the appropriate one first being multiplied by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4440-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-93900" style="width: 2.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93901"><span class="msubsup" id="MathJax-Span-93902"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-93903" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-93904"><span class="mrow" id="MathJax-Span-93905"><span class="mo" id="MathJax-Span-93906" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-93907" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4440">z^{-12}</script>.</p>

<p>12 multipliers, 24 two-term adders, and 61 delay elements to implement a full-speed 50-tap filter, as opposed to 50 multipliers, 49 delay elements and 1 fifty-term adder for the naïve implementation. The naïve implementation has less fan-out into the multipliers, but a significantly longer critical path through the final adder.</p>

<h3 id="narrowing-the-filter">Narrowing the filter</h3>

<p>A single-period matched sine filter will not be narrow enough for WWVB reception. As you can see in the figure below, the single period filter, green, has a 60 kHz bandwidth. Increasing the number of periods will narrow the filter and is best done with a second filter, either a FIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4221-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-89114" style="width: 5.858em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.258em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.154em 1000.003em 2.705em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-89115"><span class="munderover" id="MathJax-Span-89116"><span style="display: inline-block; position: relative; width: 2.705em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-89117" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.448em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-89118"><span class="mrow" id="MathJax-Span-89119"><span class="mi" id="MathJax-Span-89120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-89121" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-89122" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-89123"><span class="mrow" id="MathJax-Span-89124"><span class="mi" id="MathJax-Span-89125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-89126" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-89127" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-89128" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-89129" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-89130"><span class="mrow" id="MathJax-Span-89131"><span class="mo" id="MathJax-Span-89132" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-89133" style="font-size: 70.7%; font-family: MathJax_Main;">50</span><span class="mi" id="MathJax-Span-89134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4221">\sum_{n=0}^{N-1} z^{-50n}</script>, not shown, or an IIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4222-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-89135" style="width: 10.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.812em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-89136"><span class="mn" id="MathJax-Span-89137" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-89138"><span class="mrow" id="MathJax-Span-89139"><span class="mo" id="MathJax-Span-89140" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-89141" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-89142" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-89143" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="mo" id="MathJax-Span-89144" style="font-family: MathJax_Main; padding-left: 0.203em;">(</span><span class="mn" id="MathJax-Span-89145" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-89146" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="mn" id="MathJax-Span-89147" style="font-family: MathJax_Main; padding-left: 0.203em;">1</span><span class="texatom" id="MathJax-Span-89148"><span class="mrow" id="MathJax-Span-89149"><span class="mo" id="MathJax-Span-89150" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-89151" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-89152" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-89153"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-89154" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-89155"><span class="mrow" id="MathJax-Span-89156"><span class="mo" id="MathJax-Span-89157" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-89158" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-89159" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4222">1/(1 + (1-1/N)z^{-25} )</script>, blue.</p>

<p></p><figure><img src="images/60kHz_matched_comb_filter.png" alt="Filter characteristic" title=""> <br>
<figcaption>Comparison of FIR and IIR filters for 60 kHz</figcaption> <br>
</figure><p></p>

<p>The IIR filter results in a sharper filter for a given <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4223-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-89160" style="width: 1.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-89161"><span class="mi" id="MathJax-Span-89162" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4223">N</script> and it requires fewer delay elements. The (1-1/N) term can be implemented as a sum of bit shifts if N is a power of 2. Either filter should be placed after a decimator, 25x in this case, to reduce the number of delay elements needed.</p>

<hr>

<p></p>

<ul>
<li><a href="../">Back to Main Page</a></li>
</ul>

<p>Last updated on 2014-09-21, <em>fixed typos in equations</em></p>

<p></p>

     <!-- Markdown content ends here -->
    </div>

    <hr>
    <p>Written with <a href="https://stackedit.io/">StackEdit</a> using <a href="http://kevinburke.bitbucket.org/markdowncss/">markdown.css</a>, <a href="https://code.google.com/p/google-code-prettify/">google-code-prettify</a> and <a href="http://www.mathjax.org/">MathJax</a>.</p>

  </body>
</html>