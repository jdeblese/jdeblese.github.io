<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>Digital Filters</title>
    
    <link rel="stylesheet" type="text/css" href="http://www.thescrapyard.org/css/markdown.css" />

    <script type="text/javascript" src="http://www.thescrapyard.org/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link href="http://www.thescrapyard.org/prettify/tomorrow.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="http://www.thescrapyard.org/prettify/prettify.js"></script>

    <!-- <script type="text/javascript" src="http://www.thescrapyard.org/prettify/run_prettify.js?skin=tomorrow"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52980401-1', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body onload="prettyPrint()">
    <div class="container">
      <!-- Markdown content starts here -->

<hr>



<h1 id="digital-filters">Digital Filters</h1>

<p>A collection of various digital filters I’ve designed as they were needed for other projects.</p>

<hr>

<p><div class="toc"><div class="toc">
<ul>
<li><a href="#digital-filters">Digital Filters</a><ul>
<li><a href="#narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</a><ul>
<li><a href="#efficient-filter-implementation">Efficient filter implementation</a></li>
<li><a href="#narrowing-the-filter">Narrowing the filter</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</p>

<hr>



<h2 id="narrowband-matched-sine-fir-filter">Narrowband matched-sine FIR filter</h2>

<p>As part of my LF/VLF experiments, I wanted a narrowband 60 kHz filter for receiving the time broadcast by NIST on station <a href="http://en.wikipedia.org/wiki/WWVB">WWVB</a>. The bandwidth needed is minimal, as basic time information is only transmitted at 1 bps, so the narrower the filter, the better. I first considered a filter based on the <a href="http://en.wikipedia.org/wiki/Goertzel_algorithm">Goertzel algorithm</a>, but set it aside due to its instability and instead decided to use a <a href="http://en.wikipedia.org/wiki/Matched_filter">matched filter</a>.</p>

<h3 id="efficient-filter-implementation">Efficient filter implementation</h3>

<p>What I want to share here is not the matched filter itself, as there’s nothing special about that, but rather how it will be implemented. Given my system parameters - 60 kHz filter with a 3 MHz sampling frequency - a straightforward FIR matched filter of only one period in length would require 50 complex-coefficient taps. Using real-valued coefficients, either the sine or cosine rather than <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4370-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73108" style="width: 2.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73109"><span class="msubsup" id="MathJax-Span-73110"><span style="display: inline-block; position: relative; width: 2.155em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73111" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.503em;"><span class="texatom" id="MathJax-Span-73112"><span class="mrow" id="MathJax-Span-73113"><span class="mo" id="MathJax-Span-73114" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-73116" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-73117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4370">e^{-j2\pi}</script>, slightly distorts the filter response, but it remains acceptable. More importantly, because of symmetries in the coefficients, it is possible to reduce this filter to a 12-tap FIR filter with some additional delays and summations.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4371-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73118" style="width: 8.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.31em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73119"><span class="mi" id="MathJax-Span-73120" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-73121" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-73122" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73123" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.448em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73124"><span class="mrow" id="MathJax-Span-73125"><span class="mn" id="MathJax-Span-73126" style="font-size: 70.7%; font-family: MathJax_Main;">49</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73127"><span class="mrow" id="MathJax-Span-73128"><span class="mi" id="MathJax-Span-73129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73130" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73131" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73132" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73133" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73135"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73136" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73137"><span class="mrow" id="MathJax-Span-73138"><span class="mo" id="MathJax-Span-73139" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4371">f = \sum_{n=0}^{49}a_nz^{-n}</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4372-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73141" style="width: 6.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.109em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 3.006em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73142"><span class="msubsup" id="MathJax-Span-73143"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73144" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-73146" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="msubsup" id="MathJax-Span-73147" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 3.656em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73148" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.503em;"><span class="texatom" id="MathJax-Span-73149"><span class="mrow" id="MathJax-Span-73150"><span class="mo" id="MathJax-Span-73151" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mn" id="MathJax-Span-73153" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-73154" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-73155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-73156"><span class="mrow" id="MathJax-Span-73157"><span class="mo" id="MathJax-Span-73158" style="font-size: 70.7%; font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-73159" style="font-size: 70.7%; font-family: MathJax_Main;">50</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4372">a_n = e^{-j2\pi n/50}</script></center><p></p>

<p>These two equations give the formula for the FIR filter using the z-transform. This could be directly and inefficiently implemented as a 50-tap delay line and 50 multipliers. Examining <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4373-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73160" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73161"><span class="msubsup" id="MathJax-Span-73162"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73163" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4373">a_n</script>, however, one can see that there are only 13 unique coefficients, one of which is zero, corresponding to the values of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4374-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73165" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73166"><span class="mi" id="MathJax-Span-73167" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-73168" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-73169" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4374">sin</script> between <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4375-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73170" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73171"><span class="mn" id="MathJax-Span-73172" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4375">0</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4376-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73173" style="width: 1.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.448em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73174"><span class="mi" id="MathJax-Span-73175" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-73176"><span class="mrow" id="MathJax-Span-73177"><span class="mo" id="MathJax-Span-73178" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-73179" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4376">\pi/2</script>. All other coefficients are either mirrored or negated versions thereof. We can therefore rewrite the filter more efficiently, as follows.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4377-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73180" style="width: 13.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.864em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73181"><span class="mi" id="MathJax-Span-73182" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-73183" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-73184" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-73185" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-73186" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-73187" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73188" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73189"><span class="mrow" id="MathJax-Span-73190"><span class="mo" id="MathJax-Span-73191" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73192" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73193" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-73194" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73195" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73196"><span class="mrow" id="MathJax-Span-73197"><span class="mn" id="MathJax-Span-73198" style="font-size: 70.7%; font-family: MathJax_Main;">24</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73199"><span class="mrow" id="MathJax-Span-73200"><span class="mi" id="MathJax-Span-73201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73202" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73203" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73204" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73205" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73207"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73208" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73209"><span class="mrow" id="MathJax-Span-73210"><span class="mo" id="MathJax-Span-73211" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4377">f = (1 - z^{-25})\sum_{n=0}^{24}a_nz^{-n}</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4378-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73213" style="width: 27.28em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73214"><span class="mi" id="MathJax-Span-73215" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-73216" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-73217" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-73218" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-73219" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-73220" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73221" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73222"><span class="mrow" id="MathJax-Span-73223"><span class="mo" id="MathJax-Span-73224" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73225" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73226" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-73227" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-73228"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73229" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-73230" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73231" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="munderover" id="MathJax-Span-73232" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73233" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73234"><span class="mrow" id="MathJax-Span-73235"><span class="mn" id="MathJax-Span-73236" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73237"><span class="mrow" id="MathJax-Span-73238"><span class="mi" id="MathJax-Span-73239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73240" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73241" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73242" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73243" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73245"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73246" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73247"><span class="mrow" id="MathJax-Span-73248"><span class="mo" id="MathJax-Span-73249" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73251" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-73252" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73253" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73254"><span class="mrow" id="MathJax-Span-73255"><span class="mo" id="MathJax-Span-73256" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73257" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="munderover" id="MathJax-Span-73258" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73259" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73260"><span class="mrow" id="MathJax-Span-73261"><span class="mn" id="MathJax-Span-73262" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73263"><span class="mrow" id="MathJax-Span-73264"><span class="mi" id="MathJax-Span-73265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73266" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73267" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73268" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73269" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73270"><span class="mrow" id="MathJax-Span-73271"><span class="mn" id="MathJax-Span-73272" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-73273" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73274" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73275"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73276" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73277"><span class="mrow" id="MathJax-Span-73278"><span class="mo" id="MathJax-Span-73279" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73281" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4378">f = (1 - z^{-25})(a_0 + \sum_{n=1}^{12}a_nz^{-n} + z^{-12}\sum_{n=1}^{12}a_{12-n}z^{-n})</script></center><p></p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4379-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73282" style="width: 23.176em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.873em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73283"><span class="mi" id="MathJax-Span-73284" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-73285" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-73286" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-73287" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-73288" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-73289" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73290" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73291"><span class="mrow" id="MathJax-Span-73292"><span class="mo" id="MathJax-Span-73293" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73294" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73295" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-73296" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-73297"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73298" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-73299" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73300" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="munderover" id="MathJax-Span-73301" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73302" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73303"><span class="mrow" id="MathJax-Span-73304"><span class="mn" id="MathJax-Span-73305" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73306"><span class="mrow" id="MathJax-Span-73307"><span class="mi" id="MathJax-Span-73308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73309" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73310" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73311" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73312" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73313"><span class="mrow" id="MathJax-Span-73314"><span class="mo" id="MathJax-Span-73315" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73317" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-73318"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73319" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-73321" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-73322" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73323" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73324"><span class="mrow" id="MathJax-Span-73325"><span class="mo" id="MathJax-Span-73326" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73327" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73328"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73329" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73330"><span class="mrow" id="MathJax-Span-73331"><span class="mn" id="MathJax-Span-73332" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-73333" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73335" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-73336" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4379">f = (1 - z^{-25})(a_0 + \sum_{n=1}^{12}z^{-n}(a_n + z^{-12}a_{12-n}))</script></center><p></p>

<p>When <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4380-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73337" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73338"><span class="msubsup" id="MathJax-Span-73339"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73340" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73341" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4380">a_n</script> is defined as a function of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4381-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73342" style="width: 1.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73343"><span class="mi" id="MathJax-Span-73344" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-73345" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-73346" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4381">sin</script>, the first coefficient <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4382-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73347" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73348"><span class="msubsup" id="MathJax-Span-73349"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73350" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="mn" id="MathJax-Span-73351" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4382">a_0</script> is zero.</p>

<p></p><center><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4383-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73352" style="width: 20.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.071em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73353"><span class="mi" id="MathJax-Span-73354" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-73355" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-73356" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-73357" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-73358" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-73359" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73360" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73361"><span class="mrow" id="MathJax-Span-73362"><span class="mo" id="MathJax-Span-73363" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73364" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73365" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-73366" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-73367" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.398em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73368"><span class="mrow" id="MathJax-Span-73369"><span class="mn" id="MathJax-Span-73370" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-73371"><span class="mrow" id="MathJax-Span-73372"><span class="mi" id="MathJax-Span-73373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-73374" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-73375" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73376" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.654em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73377" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73378"><span class="mrow" id="MathJax-Span-73379"><span class="mo" id="MathJax-Span-73380" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73381" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73382" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-73383"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73384" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span><span class="mo" id="MathJax-Span-73386" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-73387" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73388" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73389"><span class="mrow" id="MathJax-Span-73390"><span class="mo" id="MathJax-Span-73391" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73392" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-73393"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73394" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73395"><span class="mrow" id="MathJax-Span-73396"><span class="mn" id="MathJax-Span-73397" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-73398" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73400" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4383">f = (1 - z^{-25})\sum_{n=1}^{12}z^{-n}(a_n + z^{-12}a_{12-n})</script></center><p></p>

<p>The first <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4384-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73401" style="width: 4.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.457em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73402"><span class="mo" id="MathJax-Span-73403" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-73404" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-73405" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-73406" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73407" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73408"><span class="mrow" id="MathJax-Span-73409"><span class="mo" id="MathJax-Span-73410" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73411" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-73412" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4384">(1-z^{-25})</script> term is easy to implement as a delay line and a sum on the input to the multipliers, or it can be placed at the output of the filter. The two sums <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4385-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73413" style="width: 1.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73414"><span class="msubsup" id="MathJax-Span-73415"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73416" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.553em;"><span class="mi" id="MathJax-Span-73417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4385">a_n</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4386-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73418" style="width: 2.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73419"><span class="msubsup" id="MathJax-Span-73420"><span style="display: inline-block; position: relative; width: 2.305em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73421" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73422"><span class="mrow" id="MathJax-Span-73423"><span class="mn" id="MathJax-Span-73424" style="font-size: 70.7%; font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-73425" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-73426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4386">a_{12-n}</script> can be computed from the same set of multipliers by using the <em>transposed form</em> of a FIR filter, summing both to the left and to the right after the multipliers. The output from these two can then be summed, the appropriate one first being multiplied by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4387-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-73427" style="width: 2.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.254em 1000.003em 2.405em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73428"><span class="msubsup" id="MathJax-Span-73429"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-73430" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-73431"><span class="mrow" id="MathJax-Span-73432"><span class="mo" id="MathJax-Span-73433" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-73434" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4387">z^{-12}</script>.</p>

<p>12 multipliers, 24 two-term adders, and 61 delay elements to implement a 50-tap filter, as opposed to 50 multipliers, 49 delay elements and 1 fifty-term adder.</p>

<h3 id="narrowing-the-filter">Narrowing the filter</h3>

<p>A single-period matched sine filter will not be narrow enough for WWVB reception. As you can see in the figure below, the single period filter, green, has a 60 kHz bandwidth. Increasing the number of periods will narrow the filter and is best done with a second filter, either a FIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4695-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78430" style="width: 5.858em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.258em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.154em 1000.003em 2.705em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78431"><span class="munderover" id="MathJax-Span-78432"><span style="display: inline-block; position: relative; width: 2.705em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-78433" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.754em 1000.003em 2.555em -0.448em); top: -2.9em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78434"><span class="mrow" id="MathJax-Span-78435"><span class="mi" id="MathJax-Span-78436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-78437" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78438" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 2.555em -0.448em); top: -2.1em; left: 1.104em;"><span class="texatom" id="MathJax-Span-78439"><span class="mrow" id="MathJax-Span-78440"><span class="mi" id="MathJax-Span-78441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78442" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-78443" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-78444" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78445" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78446"><span class="mrow" id="MathJax-Span-78447"><span class="mo" id="MathJax-Span-78448" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78449" style="font-size: 70.7%; font-family: MathJax_Main;">50</span><span class="mi" id="MathJax-Span-78450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4695">\sum_{n=0}^{N-1} z^{-50n}</script>, not shown, or an IIR filter such as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4696-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78451" style="width: 10.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.812em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78452"><span class="mn" id="MathJax-Span-78453" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-78454"><span class="mrow" id="MathJax-Span-78455"><span class="mo" id="MathJax-Span-78456" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-78457" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-78458" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78459" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="mo" id="MathJax-Span-78460" style="font-family: MathJax_Main; padding-left: 0.203em;">(</span><span class="mn" id="MathJax-Span-78461" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78462" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="mn" id="MathJax-Span-78463" style="font-family: MathJax_Main; padding-left: 0.203em;">1</span><span class="texatom" id="MathJax-Span-78464"><span class="mrow" id="MathJax-Span-78465"><span class="mo" id="MathJax-Span-78466" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-78467" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-78468" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-78469"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78470" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.553em;"><span class="texatom" id="MathJax-Span-78471"><span class="mrow" id="MathJax-Span-78472"><span class="mo" id="MathJax-Span-78473" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78474" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-78475" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4696">1/(1 + (1-1/N)z^{-25} )</script>, blue.</p>

<p><img src="/fpga/images/60kHz_matched_comb_filter.png" alt="Filter characteristic" title=""></p>

<p>The IIR filter results in a sharper filter for a given <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4697-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-78476" style="width: 1.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78477"><span class="mi" id="MathJax-Span-78478" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4697">N</script> and it requires fewer delay elements. The (1-1/N) term can be implemented as a sum of bit shifts if N is a power of 2. Either filter should be placed after a decimator, 25x in this case, to reduce the number of delay elements needed.</p>

<hr>

<ul>
<li><a href="../">Back to Main Page</a></li>
</ul>

<p>Last updated on 2014-09-17</p>

<p></p>

     <!-- Markdown content ends here -->
    </div>

    <hr>
    <p>Written with <a href="https://stackedit.io/">StackEdit</a> using <a href="http://kevinburke.bitbucket.org/markdowncss/">markdown.css</a>, <a href="https://code.google.com/p/google-code-prettify/">google-code-prettify</a> and <a href="http://www.mathjax.org/">MathJax</a>.</p>

  </body>
</html>